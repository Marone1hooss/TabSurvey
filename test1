0
1
2
3
4
5
6
7
8
10
9
11
13
12
16
14
15
17
18
19
20


----------------------------------------------------------------------------
Training NODE with config/adult.yml in env torch























----------------------------------------------------------------------------





----------------------------------------------------------------------------




----------------------------------------------------------------------------

----------------------------------------------------------------------------


----------------------------------------------------------------------------
----------------------------------------------------------------------------
Training MLP with config/adult.yml in env torch

----------------------------------------------------------------------------

----------------------------------------------------------------------------
----------------------------------------------------------------------------
Training DeepGBM with config/adult.yml in env torch
----------------------------------------------------------------------------
----------------------------------------------------------------------------
----------------------------------------------------------------------------
----------------------------------------------------------------------------
Training KNN with config/adult.yml in env sklearn
----------------------------------------------------------------------------
Training TabTransformer with config/adult.yml in env torch
----------------------------------------------------------------------------
----------------------------------------------------------------------------
Training DecisionTree with config/adult.yml in env sklearn
Training RandomForest with config/adult.yml in env sklearn


----------------------------------------------------------------------------
Training XGBoost with config/adult.yml in env gbdt
----------------------------------------------------------------------------
Training RLN with config/adult.yml in env tensorflow
Training LightGBM with config/adult.yml in env gbdt

Training STG with config/adult.yml in env torch
Training ModelTree with config/adult.yml in env gbdt
Training LinearModel with config/adult.yml in env sklearn
Training DNFNet with config/adult.yml in env tensorflow

Training CatBoost with config/adult.yml in env gbdt

Training TabNet with config/adult.yml in env torch
Training VIME with config/adult.yml in env torch




Training DeepFM with config/adult.yml in env torch

Training NAM with config/adult.yml in env torch










----------------------------------------------------------------------------


----------------------------------------------------------------------------
Training SAINT with config/adult.yml in env torch
Training DANet with config/adult.yml in env torch


Namespace(config='config/adult.yml', model_name='ModelTree', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training ModelTree with config/california_housing.yml in env gbdt

Namespace(config='config/adult.yml', model_name='LinearModel', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Namespace(config='config/adult.yml', model_name='KNN', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Namespace(config='config/adult.yml', model_name='RandomForest', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Namespace(config='config/adult.yml', model_name='DecisionTree', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
    nvmlLib = CDLL("libnvidia-ml.so.1")
    nvmlLib = CDLL("libnvidia-ml.so.1")
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:
    self._handle = _dlopen(self._name, mode)
    self._handle = _dlopen(self._name, mode)
    self._handle = _dlopen(self._name, mode)

                   ^^^^^^^^^^^^^^^^^^^^^^^^^
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
Traceback (most recent call last):
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains



During handling of the above exception, another exception occurred:
During handling of the above exception, another exception occurred:
During handling of the above exception, another exception occurred:



Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    pynvml.nvmlInit()
    pynvml.nvmlInit()
    pynvml.nvmlInit()
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    nvmlInitWithFlags(0)
    nvmlInitWithFlags(0)
    nvmlInitWithFlags(0)
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _LoadNvmlLibrary()
    _LoadNvmlLibrary()
    _LoadNvmlLibrary()
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
    raise NVMLError(ret)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
    raise NVMLError(ret)
    raise NVMLError(ret)
    raise NVMLError(ret)

pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
During handling of the above exception, another exception occurred:




During handling of the above exception, another exception occurred:
During handling of the above exception, another exception occurred:
During handling of the above exception, another exception occurred:
Traceback (most recent call last):



  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    main_once(arguments)
    main_once(arguments)
    main_once(arguments)
    sc, time = cross_validation(model, X, y, args)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    sc, time = cross_validation(model, X, y, args)
    sc, time = cross_validation(model, X, y, args)
    sc, time = cross_validation(model, X, y, args)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    train_energy= EnergyTracker()
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
                  ^^^^^^^^^^^^^^^
    train_energy= EnergyTracker()
    train_energy= EnergyTracker()
    train_energy= EnergyTracker()
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
                  ^^^^^^^^^^^^^^^
                  ^^^^^^^^^^^^^^^
                  ^^^^^^^^^^^^^^^
    devices = DeviceFactory.create_devices(domains)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    devices = DeviceFactory.create_devices(domains)
    devices = DeviceFactory.create_devices(domains)
    devices = DeviceFactory.create_devices(domains)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    device = device_type()
    device = device_type()
    device = device_type()
    Device.__init__(self)
             ^^^^^^^^^^^^^
             ^^^^^^^^^^^^^
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
    Device.__init__(self)
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    self._available_domains = self.available_domains()
    self._available_domains = self.available_domains()
    self._available_domains = self.available_domains()
    raise NoSuchDeviceError()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
                              ^^^^^^^^^^^^^^^^^^^^^^^^
                              ^^^^^^^^^^^^^^^^^^^^^^^^
pyJoules.exception.NoSuchDeviceError
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
    raise NoSuchDeviceError()
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
pyJoules.exception.NoSuchDeviceError
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training RandomForest with config/california_housing.yml in env sklearn



----------------------------------------------------------------------------
Training KNN with config/california_housing.yml in env sklearn



----------------------------------------------------------------------------
Training DecisionTree with config/california_housing.yml in env sklearn



----------------------------------------------------------------------------
Training LinearModel with config/california_housing.yml in env sklearn

Namespace(config='config/california_housing.yml', model_name='ModelTree', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training ModelTree with config/higgs.yml in env gbdt

Namespace(config='config/california_housing.yml', model_name='RandomForest', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
Namespace(config='config/california_housing.yml', model_name='KNN', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
    nvmlLib = CDLL("libnvidia-ml.so.1")
Traceback (most recent call last):
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    nvmlLib = CDLL("libnvidia-ml.so.1")
    self._handle = _dlopen(self._name, mode)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
    self._handle = _dlopen(self._name, mode)

                   ^^^^^^^^^^^^^^^^^^^^^^^^^
During handling of the above exception, another exception occurred:
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory


Traceback (most recent call last):
During handling of the above exception, another exception occurred:
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains

    pynvml.nvmlInit()
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
Namespace(config='config/california_housing.yml', model_name='DecisionTree', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    nvmlInitWithFlags(0)
Traceback (most recent call last):
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    _LoadNvmlLibrary()
    nvmlLib = CDLL("libnvidia-ml.so.1")
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
Namespace(config='config/california_housing.yml', model_name='LinearModel', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    self._handle = _dlopen(self._name, mode)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    raise NVMLError(ret)
    nvmlLib = CDLL("libnvidia-ml.so.1")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
              ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn

  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__

    raise NVMLError(ret)
During handling of the above exception, another exception occurred:
    self._handle = _dlopen(self._name, mode)
During handling of the above exception, another exception occurred:
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

                   ^^^^^^^^^^^^^^^^^^^^^^^^^


Traceback (most recent call last):
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
Traceback (most recent call last):
During handling of the above exception, another exception occurred:
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>

  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains

    main_once(arguments)
During handling of the above exception, another exception occurred:
    pynvml.nvmlInit()
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once

  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    sc, time = cross_validation(model, X, y, args)
Traceback (most recent call last):
    nvmlInitWithFlags(0)
    main_once(arguments)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    pynvml.nvmlInit()
    _LoadNvmlLibrary()
    sc, time = cross_validation(model, X, y, args)
    train_energy= EnergyTracker()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  ^^^^^^^^^^^^^^^
    nvmlInitWithFlags(0)
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    train_energy= EnergyTracker()
    devices = DeviceFactory.create_devices(domains)
    _LoadNvmlLibrary()
    raise NVMLError(ret)
                  ^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)

    devices = DeviceFactory.create_devices(domains)
    device = device_type()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
During handling of the above exception, another exception occurred:
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
             ^^^^^^^^^^^^^
    raise NVMLError(ret)

  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
Traceback (most recent call last):
    device = device_type()
    Device.__init__(self)

  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
During handling of the above exception, another exception occurred:
    main_once(arguments)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    self._available_domains = self.available_domains()

  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    Device.__init__(self)
                              ^^^^^^^^^^^^^^^^^^^^^^^^
Traceback (most recent call last):
    sc, time = cross_validation(model, X, y, args)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    self._available_domains = self.available_domains()
    raise NoSuchDeviceError()
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
                              ^^^^^^^^^^^^^^^^^^^^^^^^
pyJoules.exception.NoSuchDeviceError
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    train_energy= EnergyTracker()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    sc, time = cross_validation(model, X, y, args)
                  ^^^^^^^^^^^^^^^
    raise NoSuchDeviceError()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
pyJoules.exception.NoSuchDeviceError
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    devices = DeviceFactory.create_devices(domains)
    train_energy= EnergyTracker()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  ^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    device = device_type()
    devices = DeviceFactory.create_devices(domains)
             ^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    Device.__init__(self)
    device = device_type()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
             ^^^^^^^^^^^^^
    self._available_domains = self.available_domains()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
                              ^^^^^^^^^^^^^^^^^^^^^^^^
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    raise NoSuchDeviceError()
    self._available_domains = self.available_domains()
pyJoules.exception.NoSuchDeviceError
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training RandomForest with config/higgs.yml in env sklearn



----------------------------------------------------------------------------
Training KNN with config/higgs.yml in env sklearn





----------------------------------------------------------------------------
----------------------------------------------------------------------------
Training DecisionTree with config/higgs.yml in env sklearn
Training LinearModel with config/higgs.yml in env sklearn


Namespace(config='config/higgs.yml', model_name='ModelTree', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'


----------------------------------------------------------------------------
Training ModelTree with config/covertype.yml in env gbdt

Namespace(config='config/higgs.yml', model_name='RandomForest', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
Namespace(config='config/higgs.yml', model_name='KNN', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/gzip.py", line 192, in __init__
Namespace(config='config/higgs.yml', model_name='DecisionTree', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/gzip.py", line 192, in __init__
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/gzip.py", line 192, in __init__
Namespace(config='config/higgs.yml', model_name='LinearModel', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
    self._engine = self._make_engine(f, self.engine)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'


----------------------------------------------------------------------------
Training RandomForest with config/covertype.yml in env sklearn



----------------------------------------------------------------------------
Training KNN with config/covertype.yml in env sklearn



----------------------------------------------------------------------------
Training DecisionTree with config/covertype.yml in env sklearn



----------------------------------------------------------------------------
Training LinearModel with config/covertype.yml in env sklearn

Namespace(config='config/covertype.yml', model_name='ModelTree', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
ModelTree is not implemented for multi-class classification yet
Namespace(config='config/adult.yml', model_name='LightGBM', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Namespace(config='config/adult.yml', model_name='XGBoost', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    nvmlLib = CDLL("libnvidia-ml.so.1")
    self._handle = _dlopen(self._name, mode)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    self._handle = _dlopen(self._name, mode)
    pynvml.nvmlInit()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
Namespace(config='config/adult.yml', model_name='CatBoost', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
    nvmlInitWithFlags(0)

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
During handling of the above exception, another exception occurred:
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    _LoadNvmlLibrary()

  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
Traceback (most recent call last):
    nvmlLib = CDLL("libnvidia-ml.so.1")
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    raise NVMLError(ret)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
    self._handle = _dlopen(self._name, mode)
    nvmlInitWithFlags(0)

                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
During handling of the above exception, another exception occurred:
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
    _LoadNvmlLibrary()


  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
Traceback (most recent call last):
During handling of the above exception, another exception occurred:
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>

  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    main_once(arguments)
Traceback (most recent call last):
    raise NVMLError(ret)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
    sc, time = cross_validation(model, X, y, args)

    pynvml.nvmlInit()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
During handling of the above exception, another exception occurred:
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation

    nvmlInitWithFlags(0)
    train_energy= EnergyTracker()
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    _LoadNvmlLibrary()
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    main_once(arguments)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    devices = DeviceFactory.create_devices(domains)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    sc, time = cross_validation(model, X, y, args)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    raise NVMLError(ret)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    device = device_type()
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
    train_energy= EnergyTracker()
             ^^^^^^^^^^^^^

                  ^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
During handling of the above exception, another exception occurred:
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    Device.__init__(self)

    devices = DeviceFactory.create_devices(domains)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
Traceback (most recent call last):
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    self._available_domains = self.available_domains()
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
                              ^^^^^^^^^^^^^^^^^^^^^^^^
    main_once(arguments)
    device = device_type()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
             ^^^^^^^^^^^^^
    raise NoSuchDeviceError()
    sc, time = cross_validation(model, X, y, args)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
pyJoules.exception.NoSuchDeviceError
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    Device.__init__(self)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    self._available_domains = self.available_domains()
    devices = DeviceFactory.create_devices(domains)
                              ^^^^^^^^^^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError





----------------------------------------------------------------------------
----------------------------------------------------------------------------

Training LightGBM with config/california_housing.yml in env gbdt
Training CatBoost with config/california_housing.yml in env gbdt
----------------------------------------------------------------------------


Training XGBoost with config/california_housing.yml in env gbdt

Namespace(config='config/covertype.yml', model_name='RandomForest', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/covertype.yml', model_name='KNN', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/covertype.yml', model_name='DecisionTree', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/covertype.yml', model_name='LinearModel', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/sklearn/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/adult.yml', model_name='NAM', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 133, in main_once
    model_name = str2model(args.model_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/__init__.py", line 81, in str2model
    from models.neural_additive_models import NAM
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/neural_additive_models.py", line 4, in <module>
    from nam.config import defaults
ModuleNotFoundError: No module named 'nam'
/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/node_lib/odst.py:17: SyntaxWarning: invalid escape sequence '\i'
  """
/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
Namespace(config='config/adult.yml', model_name='TabNet', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/adult.yml', model_name='MLP', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
On Device: cpu
Namespace(config='config/adult.yml', model_name='VIME', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
On Device: cpu
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
Namespace(config='config/adult.yml', model_name='DeepFM', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

During handling of the above exception, another exception occurred:

During handling of the above exception, another exception occurred:

Traceback (most recent call last):

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
    pynvml.nvmlInit()
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
    nvmlInitWithFlags(0)
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
    _LoadNvmlLibrary()
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
    raise NVMLError(ret)
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found



During handling of the above exception, another exception occurred:
During handling of the above exception, another exception occurred:
During handling of the above exception, another exception occurred:



Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
    main_once(arguments)
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
    sc, time = cross_validation(model, X, y, args)
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
    train_energy= EnergyTracker()
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
                  ^^^^^^^^^^^^^^^
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
    devices = DeviceFactory.create_devices(domains)
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
    device = device_type()
             ^^^^^^^^^^^^^
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
    raise NoSuchDeviceError()
Namespace(config='config/adult.yml', model_name='TabTransformer', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
[9, 16, 7, 15, 6, 5, 2, 42]
On Device: cpu
Using dim 128 and batch size 128
On Device: cpu
pyJoules.exception.NoSuchDeviceError
pyJoules.exception.NoSuchDeviceError
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/adult.yml', model_name='SAINT', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Using dim 32 and batch size 128
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training NAM with config/california_housing.yml in env torch



----------------------------------------------------------------------------
Training TabNet with config/california_housing.yml in env torch



----------------------------------------------------------------------------
Training TabTransformer with config/california_housing.yml in env torch



----------------------------------------------------------------------------
Training VIME with config/california_housing.yml in env torch



----------------------------------------------------------------------------
Training DeepFM with config/california_housing.yml in env torch



----------------------------------------------------------------------------
Training MLP with config/california_housing.yml in env torch



----------------------------------------------------------------------------
Training SAINT with config/california_housing.yml in env torch

Namespace(config='config/adult.yml', model_name='NODE', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
On: cpu
On Device: cpu
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/california_housing.yml', model_name='LightGBM', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/california_housing.yml', model_name='XGBoost', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/california_housing.yml', model_name='CatBoost', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training LightGBM with config/higgs.yml in env gbdt

Namespace(config='config/adult.yml', model_name='DeepGBM', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
{'task': 'binary', 'batch_size': 128, 'test_batch_size': 256, 'l2_reg': 1e-06, 'l2_reg_opt': 0.0005, 'lr': 0.001, 'epochs': 3, 'early_stopping': 3, 'loss_de': 10, 'loss_dr': 0.7, 'device': device(type='cpu'), 'bins': 32, 'rate': 0.9, 'threshold': 10, 'maxleaf': 64, 'num_slices': 5, 'n_feature': 128, 'n_clusters': 10, 'tree_lr': 0.1, 'n_trees': 200, 'embsize': 20, 'emb_lr': 0.001, 'emb_epochs': 3, 'tree_layers': [100, 100, 100, 50, 20], 'embedding_size': 20, 'cate_layers': [16, 16], 'online_epochs': 1, 'online_bz': 4096, 'num_splits': 5, 'early-stopping': 20}

Traceback (most recent call last):

  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
----------------------------------------------------------------------------
Training XGBoost with config/higgs.yml in env gbdt

    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn

    raise NVMLError(ret)

pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
----------------------------------------------------------------------------

Training CatBoost with config/higgs.yml in env gbdt
During handling of the above exception, another exception occurred:


Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training NODE with config/california_housing.yml in env torch



----------------------------------------------------------------------------
Training DeepGBM with config/california_housing.yml in env torch

Namespace(config='config/adult.yml', model_name='DANet', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Device used : cpu
DANetClassifier(std=None, drop_rate=0, layer=8, base_outdim=96, k=4, clip_value=2, seed=324, verbose=1, optimizer_fn=<class 'qhoptim.pyt.qhadam.QHAdam'>, optimizer_params={'lr': 0.008, 'weight_decay': 1e-05, 'nus': (0.8, 1.0)}, scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, scheduler_params={'gamma': 0.95, 'step_size': 20}, input_dim=None, output_dim=None, device_name='auto')
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/higgs.yml', model_name='LightGBM', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
Namespace(config='config/higgs.yml', model_name='XGBoost', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
Namespace(config='config/higgs.yml', model_name='CatBoost', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/gzip.py", line 174, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'


----------------------------------------------------------------------------
Training DANet with config/california_housing.yml in env torch



----------------------------------------------------------------------------
Training LightGBM with config/covertype.yml in env gbdt



----------------------------------------------------------------------------
Training XGBoost with config/covertype.yml in env gbdt



----------------------------------------------------------------------------
Training CatBoost with config/covertype.yml in env gbdt

Namespace(config='config/california_housing.yml', model_name='NAM', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 133, in main_once
    model_name = str2model(args.model_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/__init__.py", line 81, in str2model
    from models.neural_additive_models import NAM
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/neural_additive_models.py", line 4, in <module>
    from nam.config import defaults
ModuleNotFoundError: No module named 'nam'
/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
Namespace(config='config/california_housing.yml', model_name='TabNet', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/california_housing.yml', model_name='VIME', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
On Device: cpu
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/california_housing.yml', model_name='TabTransformer', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
()
On Device: cpu
Using dim 256 and batch size 128
On Device: cpu
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/california_housing.yml', model_name='MLP', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
On Device: cpu
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
Namespace(config='config/california_housing.yml', model_name='DeepFM', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
    nvmlLib = CDLL("libnvidia-ml.so.1")
Traceback (most recent call last):
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    nvmlLib = CDLL("libnvidia-ml.so.1")
    self._handle = _dlopen(self._name, mode)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
    self._handle = _dlopen(self._name, mode)

                   ^^^^^^^^^^^^^^^^^^^^^^^^^
During handling of the above exception, another exception occurred:
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory


Traceback (most recent call last):
During handling of the above exception, another exception occurred:
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains

    pynvml.nvmlInit()
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    nvmlInitWithFlags(0)
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    _LoadNvmlLibrary()
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    raise NVMLError(ret)
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn

    raise NVMLError(ret)
During handling of the above exception, another exception occurred:
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found


Traceback (most recent call last):
During handling of the above exception, another exception occurred:
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>

    main_once(arguments)
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    sc, time = cross_validation(model, X, y, args)
    main_once(arguments)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    sc, time = cross_validation(model, X, y, args)
    train_energy= EnergyTracker()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    train_energy= EnergyTracker()
    devices = DeviceFactory.create_devices(domains)
                  ^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    devices = DeviceFactory.create_devices(domains)
    device = device_type()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    device = device_type()
    Device.__init__(self)
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    self._available_domains = self.available_domains()
    Device.__init__(self)
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    self._available_domains = self.available_domains()
    raise NoSuchDeviceError()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
pyJoules.exception.NoSuchDeviceError
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training NAM with config/higgs.yml in env torch



----------------------------------------------------------------------------
Training VIME with config/higgs.yml in env torch



----------------------------------------------------------------------------
Training TabTransformer with config/higgs.yml in env torch



----------------------------------------------------------------------------
Training TabNet with config/higgs.yml in env torch



----------------------------------------------------------------------------
Training DeepFM with config/higgs.yml in env torch



----------------------------------------------------------------------------
Training MLP with config/higgs.yml in env torch

/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/node_lib/odst.py:17: SyntaxWarning: invalid escape sequence '\i'
  """
Namespace(config='config/california_housing.yml', model_name='SAINT', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Using dim 256 and batch size 128
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/california_housing.yml', model_name='NODE', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
On: cpu
On Device: cpu
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training SAINT with config/higgs.yml in env torch

Namespace(config='config/california_housing.yml', model_name='DeepGBM', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
{'task': 'regression', 'batch_size': 128, 'test_batch_size': 256, 'l2_reg': 1e-06, 'l2_reg_opt': 0.0005, 'lr': 0.001, 'epochs': 3, 'early_stopping': 3, 'loss_de': 5, 'loss_dr': 0.9, 'device': device(type='cpu'), 'bins': 32, 'rate': 0.9, 'threshold': 10, 'maxleaf': 128, 'num_slices': 5, 'n_feature': 128, 'n_clusters': 10, 'tree_lr': 0.1, 'n_trees': 100, 'embsize': 20, 'emb_lr': 0.001, 'emb_epochs': 3, 'tree_layers': [100, 100, 100, 50, 20], 'embedding_size': 20, 'cate_layers': [16, 16], 'online_epochs': 1, 'online_bz': 4096, 'num_splits': 5, 'early-stopping': 20}
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training NODE with config/higgs.yml in env torch

Namespace(config='config/higgs.yml', model_name='NAM', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'


----------------------------------------------------------------------------
Training DeepGBM with config/higgs.yml in env torch

Namespace(config='config/higgs.yml', model_name='VIME', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
Namespace(config='config/higgs.yml', model_name='TabNet', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
Namespace(config='config/higgs.yml', model_name='TabTransformer', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
Namespace(config='config/higgs.yml', model_name='DeepFM', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
Namespace(config='config/higgs.yml', model_name='MLP', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'


----------------------------------------------------------------------------
Training NAM with config/covertype.yml in env torch



----------------------------------------------------------------------------
Training VIME with config/covertype.yml in env torch



----------------------------------------------------------------------------
Training TabNet with config/covertype.yml in env torch



----------------------------------------------------------------------------
Training TabTransformer with config/covertype.yml in env torch



----------------------------------------------------------------------------
Training DeepFM with config/covertype.yml in env torch



----------------------------------------------------------------------------
Training MLP with config/covertype.yml in env torch

Namespace(config='config/california_housing.yml', model_name='DANet', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Device used : cpu
DANetRegressor(std=None, drop_rate=0, layer=10, base_outdim=96, k=3, clip_value=2, seed=324, verbose=1, optimizer_fn=<class 'qhoptim.pyt.qhadam.QHAdam'>, optimizer_params={'lr': 0.008, 'weight_decay': 1e-05, 'nus': (0.8, 1.0)}, scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, scheduler_params={'gamma': 0.95, 'step_size': 20}, input_dim=None, output_dim=None, device_name='auto')
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/higgs.yml', model_name='SAINT', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
Namespace(config='config/higgs.yml', model_name='NODE', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
Namespace(config='config/covertype.yml', model_name='LightGBM', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training SAINT with config/covertype.yml in env torch

Namespace(config='config/covertype.yml', model_name='XGBoost', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training DANet with config/higgs.yml in env torch

Namespace(config='config/covertype.yml', model_name='CatBoost', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/ctypes/__init__.py", line 376, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/gbdt/lib/python3.11/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training NODE with config/covertype.yml in env torch

Namespace(config='config/higgs.yml', model_name='DeepGBM', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'


----------------------------------------------------------------------------
Training DeepGBM with config/covertype.yml in env torch

Namespace(config='config/higgs.yml', model_name='DANet', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'


----------------------------------------------------------------------------
Training DANet with config/covertype.yml in env torch

WARNING:tensorflow:From /srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/dnf.py:54: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From /srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/dnf.py:55: The name tf.random.set_random_seed is deprecated. Please use tf.compat.v1.random.set_random_seed instead.

Namespace(batch_size=128, cat_dims=[9, 16, 7, 15, 6, 5, 2, 42], cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], config='config/adult.yml', data_parallel=True, dataset='Adult', direction='maximize', early_stopping_rounds=20, epochs=3, gpu_ids=[0, 1], logging_period=100, model_name='DNFNet', n_trials=2, num_classes=1, num_features=14, num_splits=5, objective='binary', one_hot_encode=False, optimize_hyperparameters=False, scale=True, seed=221, shuffle=True, target_encode=True, use_gpu=True, val_batch_size=256)
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
{'n_conjunctions_arr': [6, 9, 12, 15], 'conjunctions_depth_arr': [2, 4, 6], 'keep_feature_prob_arr': [0.1, 0.3, 0.5, 0.7, 0.9], 'initial_lr': 0.05, 'lr_decay_factor': 0.5, 'lr_patience': 10, 'min_lr': 1e-06, 'early_stopping_patience': 20, 'epochs': 3, 'batch_size': 128, 'apply_standardization': True, 'save_weights': True, 'starting_epoch_to_save': 0, 'models_module_name': 'models.dnf_lib.DNFNet.DNFNetModels', 'models_dir': 'models/dnf_lib/DNFNet/DNFNetModels', 'model_number': 1, 'experiments_dir': 'output/DNFNet/experiments/Adult', 'competition_name': 'Adult', 'model_name': 'DNFNet', 'n_formulas': 64, 'orthogonal_lambda': 0.0, 'elastic_net_beta': 1.3, 'random_seed': 1306, 'input_dim': 14, 'output_dim': 1, 'translate_label_to_one_hot': False, 'experiment_number': 1, 'GPU': '[0, 1]', 'n_forumlas': 1024}
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/ctypes/__init__.py", line 364, in __init__
    self._handle = _dlopen(self._name, mode)
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "train.py", line 154, in <module>
    main_once(arguments)
  File "train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
  File "train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Using TensorFlow backend.
Namespace(batch_size=128, cat_dims=[9, 16, 7, 15, 6, 5, 2, 42], cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], config='config/adult.yml', data_parallel=True, dataset='Adult', direction='maximize', early_stopping_rounds=20, epochs=3, gpu_ids=[0, 1], logging_period=100, model_name='RLN', n_trials=2, num_classes=1, num_features=14, num_splits=5, objective='binary', one_hot_encode=False, optimize_hyperparameters=False, scale=True, seed=221, shuffle=True, target_encode=True, use_gpu=True, val_batch_size=256)
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/ctypes/__init__.py", line 364, in __init__
    self._handle = _dlopen(self._name, mode)
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "train.py", line 154, in <module>
    main_once(arguments)
  File "train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
  File "train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/covertype.yml', model_name='NAM', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 133, in main_once
    model_name = str2model(args.model_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/__init__.py", line 81, in str2model
    from models.neural_additive_models import NAM
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/neural_additive_models.py", line 4, in <module>
    from nam.config import defaults
ModuleNotFoundError: No module named 'nam'
Namespace(config='config/covertype.yml', model_name='VIME', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
On Device: cpu
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
Namespace(config='config/covertype.yml', model_name='TabNet', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/adult.yml', model_name='STG', dataset='Adult', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=14, num_classes=1, cat_idx=[1, 3, 5, 6, 7, 8, 9, 13], cat_dims=[9, 16, 7, 15, 6, 5, 2, 42])
Train model with given hyperparameters
Loading dataset Adult...
Dataset loaded!
(32561, 14)
Scaling the data...
Namespace(config='config/covertype.yml', model_name='TabTransformer', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
()
On Device: cpu
Using dim 8 and batch size 64
On Device: cpu
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:
    self._handle = _dlopen(self._name, mode)

                   ^^^^^^^^^^^^^^^^^^^^^^^^^
Traceback (most recent call last):
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains

    pynvml.nvmlInit()
During handling of the above exception, another exception occurred:
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit

Traceback (most recent call last):
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    pynvml.nvmlInit()
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    nvmlInitWithFlags(0)
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    _LoadNvmlLibrary()
    raise NVMLError(ret)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)

  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
During handling of the above exception, another exception occurred:
    raise NVMLError(ret)

pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found
Traceback (most recent call last):

  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
During handling of the above exception, another exception occurred:
    main_once(arguments)

  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
Traceback (most recent call last):
    sc, time = cross_validation(model, X, y, args)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    train_energy= EnergyTracker()
    sc, time = cross_validation(model, X, y, args)
                  ^^^^^^^^^^^^^^^
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    devices = DeviceFactory.create_devices(domains)
    train_energy= EnergyTracker()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  ^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    device = device_type()
    devices = DeviceFactory.create_devices(domains)
             ^^^^^^^^^^^^^
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    device = device_type()
    self._available_domains = self.available_domains()
             ^^^^^^^^^^^^^
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    Device.__init__(self)
    raise NoSuchDeviceError()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
pyJoules.exception.NoSuchDeviceError
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/covertype.yml', model_name='DeepFM', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
DeepFM not yet implemented for classification
Namespace(config='config/covertype.yml', model_name='MLP', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
On Device: cpu
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError




----------------------------------------------------------------------------
----------------------------------------------------------------------------
Training RLN with config/california_housing.yml in env tensorflow
Training DNFNet with config/california_housing.yml in env tensorflow


Namespace(config='config/covertype.yml', model_name='SAINT', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Using dim 8 and batch size 64
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training STG with config/california_housing.yml in env torch

/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/models/node_lib/odst.py:17: SyntaxWarning: invalid escape sequence '\i'
  """
Namespace(config='config/covertype.yml', model_name='NODE', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
On: cpu
On Device: cpu
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
Namespace(config='config/covertype.yml', model_name='DeepGBM', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
DeepGBM not implemented for classification!
Namespace(batch_size=128, cat_dims=None, cat_idx=None, config='config/california_housing.yml', data_parallel=True, dataset='CaliforniaHousing', direction='minimize', early_stopping_rounds=20, epochs=3, gpu_ids=[0, 1], logging_period=100, model_name='RLN', n_trials=2, num_classes=1, num_features=8, num_splits=5, objective='regression', one_hot_encode=False, optimize_hyperparameters=False, scale=True, seed=221, shuffle=True, target_encode=False, use_gpu=True, val_batch_size=256)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Namespace(batch_size=128, cat_dims=None, cat_idx=None, config='config/california_housing.yml', data_parallel=True, dataset='CaliforniaHousing', direction='minimize', early_stopping_rounds=20, epochs=3, gpu_ids=[0, 1], logging_period=100, model_name='DNFNet', n_trials=2, num_classes=1, num_features=8, num_splits=5, objective='regression', one_hot_encode=False, optimize_hyperparameters=False, scale=True, seed=221, shuffle=True, target_encode=False, use_gpu=True, val_batch_size=256)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Traceback (most recent call last):
  File "train.py", line 154, in <module>
    main_once(arguments)
  File "train.py", line 131, in main_once
    X, y = load_data(args)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 20, in load_data
    X, y = sklearn.datasets.fetch_california_housing(return_X_y=True)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/sklearn/datasets/_california_housing.py", line 150, in fetch_california_housing
    cal_housing = joblib.load(filepath)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/joblib/numpy_pickle.py", line 587, in load
    obj = _unpickle(fobj, filename, mmap_mode)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/joblib/numpy_pickle.py", line 506, in _unpickle
    obj = unpickler.load()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/pickle.py", line 1088, in load
    dispatch[key[0]](self)
KeyError: 192
Traceback (most recent call last):
  File "train.py", line 154, in <module>
    main_once(arguments)
  File "train.py", line 131, in main_once
    X, y = load_data(args)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 20, in load_data
    X, y = sklearn.datasets.fetch_california_housing(return_X_y=True)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/sklearn/datasets/_california_housing.py", line 150, in fetch_california_housing
    cal_housing = joblib.load(filepath)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/joblib/numpy_pickle.py", line 587, in load
    obj = _unpickle(fobj, filename, mmap_mode)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/joblib/numpy_pickle.py", line 506, in _unpickle
    obj = unpickler.load()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/pickle.py", line 1088, in load
    dispatch[key[0]](self)
KeyError: 192


----------------------------------------------------------------------------
Training DNFNet with config/higgs.yml in env tensorflow



----------------------------------------------------------------------------
Training RLN with config/higgs.yml in env tensorflow

Namespace(config='config/covertype.yml', model_name='DANet', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 135, in main_once
    parameters = args.parameters[args.dataset][args.model_name]
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
KeyError: 'DANet'
Namespace(batch_size=1024, cat_dims=None, cat_idx=[27], config='config/higgs.yml', data_parallel=True, dataset='HIGGS', direction='maximize', early_stopping_rounds=20, epochs=3, gpu_ids=[0, 1], logging_period=100, model_name='DNFNet', n_trials=2, num_classes=1, num_features=28, num_splits=3, objective='binary', one_hot_encode=False, optimize_hyperparameters=False, scale=True, seed=221, shuffle=True, target_encode=False, use_gpu=True, val_batch_size=1024)
Train model with given hyperparameters
Loading dataset HIGGS...
Namespace(batch_size=1024, cat_dims=None, cat_idx=[27], config='config/higgs.yml', data_parallel=True, dataset='HIGGS', direction='maximize', early_stopping_rounds=20, epochs=3, gpu_ids=[0, 1], logging_period=100, model_name='RLN', n_trials=2, num_classes=1, num_features=28, num_splits=3, objective='binary', one_hot_encode=False, optimize_hyperparameters=False, scale=True, seed=221, shuffle=True, target_encode=False, use_gpu=True, val_batch_size=1024)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "train.py", line 154, in <module>
    main_once(arguments)
  File "train.py", line 131, in main_once
    X, y = load_data(args)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 586, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 482, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 811, in __init__
    self._engine = self._make_engine(self.engine)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 1040, in _make_engine
    return mapping[engine](self.f, **self.options)  # type: ignore[call-arg]
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 51, in __init__
    self._open_handles(src, kwds)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/base_parser.py", line 229, in _open_handles
    errors=kwds.get("encoding_errors", "strict"),
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/common.py", line 645, in get_handle
    **compression_args,
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/gzip.py", line 168, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'
Traceback (most recent call last):
  File "train.py", line 154, in <module>
    main_once(arguments)
  File "train.py", line 131, in main_once
    X, y = load_data(args)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 586, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 482, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 811, in __init__
    self._engine = self._make_engine(self.engine)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/readers.py", line 1040, in _make_engine
    return mapping[engine](self.f, **self.options)  # type: ignore[call-arg]
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 51, in __init__
    self._open_handles(src, kwds)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/parsers/base_parser.py", line 229, in _open_handles
    errors=kwds.get("encoding_errors", "strict"),
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/pandas/io/common.py", line 645, in get_handle
    **compression_args,
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/gzip.py", line 168, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'


----------------------------------------------------------------------------
Training RLN with config/covertype.yml in env tensorflow



----------------------------------------------------------------------------
Training DNFNet with config/covertype.yml in env tensorflow

Namespace(config='config/california_housing.yml', model_name='STG', dataset='CaliforniaHousing', objective='regression', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=8, num_classes=1, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset CaliforniaHousing...
Dataset loaded!
(20640, 8)
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError


----------------------------------------------------------------------------
Training STG with config/higgs.yml in env torch

Namespace(batch_size=128, cat_dims=None, cat_idx=None, config='config/covertype.yml', data_parallel=True, dataset='Covertype', direction='minimize', early_stopping_rounds=20, epochs=3, gpu_ids=[0, 1], logging_period=100, model_name='RLN', n_trials=2, num_classes=7, num_features=54, num_splits=5, objective='classification', one_hot_encode=False, optimize_hyperparameters=False, scale=True, seed=221, shuffle=True, target_encode=True, use_gpu=True, val_batch_size=256)
Train model with given hyperparameters
Loading dataset Covertype...
Namespace(batch_size=128, cat_dims=None, cat_idx=None, config='config/covertype.yml', data_parallel=True, dataset='Covertype', direction='minimize', early_stopping_rounds=20, epochs=3, gpu_ids=[0, 1], logging_period=100, model_name='DNFNet', n_trials=2, num_classes=7, num_features=54, num_splits=5, objective='classification', one_hot_encode=False, optimize_hyperparameters=False, scale=True, seed=221, shuffle=True, target_encode=True, use_gpu=True, val_batch_size=256)
Train model with given hyperparameters
Loading dataset Covertype...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/sklearn/datasets/_covtype.py", line 170, in fetch_covtype
    X, y
UnboundLocalError: local variable 'X' referenced before assignment

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "train.py", line 154, in <module>
    main_once(arguments)
  File "train.py", line 131, in main_once
    X, y = load_data(args)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 23, in load_data
    X, y = sklearn.datasets.fetch_covtype(return_X_y=True)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/sklearn/datasets/_covtype.py", line 172, in fetch_covtype
    X = joblib.load(samples_path)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/joblib/numpy_pickle.py", line 587, in load
    obj = _unpickle(fobj, filename, mmap_mode)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/joblib/numpy_pickle.py", line 506, in _unpickle
    obj = unpickler.load()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/pickle.py", line 1088, in load
    dispatch[key[0]](self)
KeyError: 0
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/sklearn/datasets/_covtype.py", line 170, in fetch_covtype
    X, y
UnboundLocalError: local variable 'X' referenced before assignment

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "train.py", line 154, in <module>
    main_once(arguments)
  File "train.py", line 131, in main_once
    X, y = load_data(args)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 23, in load_data
    X, y = sklearn.datasets.fetch_covtype(return_X_y=True)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/sklearn/datasets/_covtype.py", line 172, in fetch_covtype
    X = joblib.load(samples_path)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/joblib/numpy_pickle.py", line 587, in load
    obj = _unpickle(fobj, filename, mmap_mode)
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/site-packages/joblib/numpy_pickle.py", line 506, in _unpickle
    obj = unpickler.load()
  File "/home/marwan.housni/.conda/envs/tensorflow/lib/python3.7/pickle.py", line 1088, in load
    dispatch[key[0]](self)
KeyError: 0
Namespace(config='config/higgs.yml', model_name='STG', dataset='HIGGS', objective='binary', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='maximize', num_splits=3, shuffle=True, seed=221, scale=True, target_encode=False, one_hot_encode=False, batch_size=1024, val_batch_size=1024, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=28, num_classes=1, cat_idx=[27], cat_dims=None)
Train model with given hyperparameters
Loading dataset HIGGS...
Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 131, in main_once
    X, y = load_data(args)
           ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/load_data.py", line 78, in load_data
    df = pd.read_csv(path, header=None)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pandas/io/common.py", line 765, in get_handle
    handle = gzip.GzipFile(  # type: ignore[assignment]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/gzip.py", line 192, in __init__
    fileobj = self.myfileobj = builtins.open(filename, mode or 'rb')
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/data/HIGGS.csv.gz'


----------------------------------------------------------------------------
Training STG with config/covertype.yml in env torch

Namespace(config='config/covertype.yml', model_name='STG', dataset='Covertype', objective='classification', use_gpu=True, gpu_ids=[0, 1], data_parallel=True, optimize_hyperparameters=False, n_trials=2, direction='minimize', num_splits=5, shuffle=True, seed=221, scale=True, target_encode=True, one_hot_encode=False, batch_size=128, val_batch_size=256, early_stopping_rounds=20, epochs=3, logging_period=100, num_features=54, num_classes=7, cat_idx=None, cat_dims=None)
Train model with given hyperparameters
Loading dataset Covertype...
Dataset loaded!
(581012, 54)
Having 7 classes as target.
Scaling the data...
Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1798, in _LoadNvmlLibrary
    nvmlLib = CDLL("libnvidia-ml.so.1")
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/ctypes/__init__.py", line 379, in __init__
    self._handle = _dlopen(self._name, mode)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: libnvidia-ml.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 84, in available_domains
    pynvml.nvmlInit()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1770, in nvmlInit
    nvmlInitWithFlags(0)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1753, in nvmlInitWithFlags
    _LoadNvmlLibrary()
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 1800, in _LoadNvmlLibrary
    _nvmlCheckReturn(NVML_ERROR_LIBRARY_NOT_FOUND)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pynvml/nvml.py", line 833, in _nvmlCheckReturn
    raise NVMLError(ret)
pynvml.nvml.NVMLError_LibraryNotFound: NVML Shared Library Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 154, in <module>
    main_once(arguments)
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 138, in main_once
    sc, time = cross_validation(model, X, y, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/train.py", line 22, in cross_validation
    train_energy= EnergyTracker()
                  ^^^^^^^^^^^^^^^
  File "/srv/lustre01/project/manapy-um6p-st-msda-1wabcjwe938/users/marwan.housni/TabSurvey/utils/energieTracker.py", line 13, in __init__
    devices = DeviceFactory.create_devices(domains)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device_factory.py", line 77, in create_devices
    device = device_type()
             ^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 71, in __init__
    Device.__init__(self)
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/device.py", line 39, in __init__
    self._available_domains = self.available_domains()
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/marwan.housni/.conda/envs/torch/lib/python3.12/site-packages/pyJoules/device/nvidia_device.py", line 86, in available_domains
    raise NoSuchDeviceError()
pyJoules.exception.NoSuchDeviceError
